<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="book">

	<select id="list" resultType="BookDto">
		select * from book order by
		book_title asc
	</select>

	<insert id="save">
		insert into book
		values(book_seq.nextval,
		#{bookTitle}, #{bookAuthor},
		#{bookPublicationDate}, #{bookPrice}, #{bookPublisher},
		#{bookPageCount}, #{bookGenre})
	</insert>

	<delete id="remove">
		delete book where book_id = #{bookId}
	</delete>

	<select id="find" resultType="BookDto">
		select * from book where book_id =
		#{bookId}
	</select>

	<select id="findTitle" resultType="BookDto">
		select * from book where UPPER(book_title) like '%' || UPPER(#{bookTitle})
		|| '%'
	</select>

	<update id="edit">
		update book
		set
		<if test="dto.bookId > 0">
			book_id = #{dto.bookId},
		</if>
		book_title = #{dto.bookTitle},
		book_author = #{dto.bookAuthor},
		book_publication_date =
		#{dto.bookPublicationDate},
		book_price = #{dto.bookPrice},
		book_publisher = #{dto.bookPublisher},
		book_page_count = #{dto.bookPageCount},
		book_genre = #{dto.bookGenre}
		where book_id = #{bookId}
	</update>

	<update id="editUnit">
		update book
		<set>
			<if test="dto.bookId > 0">book_id = #{dto.bookId},</if>
			<if test="dto.bookTitle != null">book_title = #{dto.bookTitle},</if>
			<if test="dto.bookAuthor != null">book_author = #{dto.bookAuthor},</if>
			<if test="dto.bookPublicationDate != null">book_publication_date = #{dto.bookPublicationDate},</if>
			<if test="dto.bookPrice > 0">book_price = #{dto.bookPrice},</if>
			<if test="dto.bookPublisher != null">book_publisher = #{dto.bookPublisher},</if>
			<if test="dto.bookPageCount > 0">book_page_count = #{dto.bookPageCount},</if>
			<if test="dto.bookGenre != null">book_genre = #{dto.bookGenre},</if>
		</set>
		where book_id = #{bookId}
	</update>

</mapper>